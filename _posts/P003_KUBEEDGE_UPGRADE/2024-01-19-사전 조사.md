---
title: what is kubeedge?
author: bami jeong
categories:
  - Kubeedge
tags:
  - Research
  - Kubeedge
  - Migration
category: kubeedge
---



## Project Name: 
#### Date: 2024-01-09 17:24 
#### Tag: #kubeedge #migration #intro
---
# Contents:
1. 현재 v1.15가 가장 최신
2. keadm을 이용하여 설치가 진행
3. Cotainer Platform Rols에서 사용하는 폴더 조사

## Kubeedge 배포 파일 
### deploy-cp-edge.sh
```yaml
sed -i "s/{CLOUDCORE1_NODE_HOSTNAME}/$CLOUDCORE1_NODE_HOSTNAME/g" roles/cp/edge/keadm_init/defaults/main.yml
sed -i "s/{CLOUDCORE2_NODE_HOSTNAME}/$CLOUDCORE2_NODE_HOSTNAME/g" roles/cp/edge/keadm_init/defaults/main.yml

sed -i "s/{CLOUDCORE_VIP}/$CLOUDCORE_VIP/g" roles/cp/edge/keadm_join/defaults/main.yml

sed -i "s/{MASTER_NODE_HOSTNAME}/$MASTER1_NODE_HOSTNAME/g" ../edge/edgemesh/agent/04-configmap.yaml
sed -i "s/{CLOUDCORE_VIP}/$CLOUDCORE_VIP/g" ../edge/edgemesh/agent/04-configmap.yaml

sed -i "s/{CLOUDCORE_VIP}/$CLOUDCORE_VIP/g" ../edge/ha-cloudcore/02-ha-configmap.yaml

# Deploy Container Platform Edge
ansible-playbook -i inventory/mycluster/edge-hosts.yaml  --become --become-user=root playbooks/edge.yml
```
### cp-edge-vars.sh
```sh
#!/bin/bash

export CLOUDCORE_VIP=

export CLOUDCORE1_NODE_HOSTNAME=
export CLOUDCORE2_NODE_HOSTNAME=

export EDGE_HOSTS=

export EDGE1_NODE_HOSTNAME=
export EDGE1_NODE_PRIVATE_IP=
```
### edge.yml
```yaml
---
- hosts: cloudcore_node
  gather_facts: False
  any_errors_fatal: "{{ any_errors_fatal | default(true) }}"
  environment: "{{ proxy_disable_env }}"
  roles:
    - { role: kubespray-defaults }
    - { role: cp/edge/keadm_amd64 }

- hosts: edge_node
  gather_facts: False
  any_errors_fatal: "{{ any_errors_fatal | default(true) }}"
  environment: "{{ proxy_disable_env }}"
  roles:
    - { role: kubespray-defaults }
    - { role: cp/edge/keadm_arm64 }

- hosts: cloudcore_node
  gather_facts: False
  any_errors_fatal: "{{ any_errors_fatal | default(true) }}"
  environment: "{{ proxy_disable_env }}"
  roles:
    - { role: kubespray-defaults }
    - { role: cp/edge/keadm_init }

- hosts: edge_node
  gather_facts: False
  any_errors_fatal: "{{ any_errors_fatal | default(true) }}"
  environment: "{{ proxy_disable_env }}"
  roles:
    - { role: kubespray-defaults }
    - { role: cp/edge/cri_install }
    - { role: cp/edge/keadm_join }

- hosts: edge_node
  gather_facts: False
  any_errors_fatal: "{{ any_errors_fatal | default(true) }}"
  environment: "{{ proxy_disable_env }}"
  roles:
    - { role: kubespray-defaults }
    - { role: cp/edge/edgecore }

- hosts: cloudcore_node
  gather_facts: False
  any_errors_fatal: "{{ any_errors_fatal | default(true) }}"
  environment: "{{ proxy_disable_env }}"
  roles:
    - { role: kubespray-defaults }
    - { role: cp/edge/edgemesh }

- hosts: cloudcore_node
  gather_facts: False
  any_errors_fatal: "{{ any_errors_fatal | default(true) }}"
  environment: "{{ proxy_disable_env }}"
  roles:
    - { role: kubespray-defaults }
    - { role: cp/cve_cce/amd64 }

- hosts: edge_node
  gather_facts: False
  any_errors_fatal: "{{ any_errors_fatal | default(true) }}"
  environment: "{{ proxy_disable_env }}"
  roles:
    - { role: kubespray-defaults }
    - { role: cp/cve_cce/arm64 }

```

### 파일 구조
```sh
## 설치 경로
ubuntu@cp-cluster-master:~/cp-deployment/edge$ tree
.
├── README.md
├── edgemesh
│   ├── agent
│   │   ├── 01-serviceaccount.yaml
│   │   ├── 02-clusterrole.yaml
│   │   ├── 03-clusterrolebinding.yaml
│   │   ├── 04-configmap.yaml
│   │   └── 05-daemonset.yaml
│   └── crds
│       └── istio
│           ├── crd-destinationrule.yaml
│           ├── crd-gateway.yaml
│           └── crd-virtualservice.yaml
├── ha-cloudcore
│   ├── 01-ha-prepare.yaml
│   ├── 02-ha-configmap.yaml
│   ├── 03-ha-deployment.yaml
│   └── kube-proxy.yaml
├── keadm
│   ├── amd64
│   │   ├── keadm
│   │   └── version
│   └── arm64
│       ├── keadm
│       └── version
└── security.bin

## Roles 경로 
cp-deployment/standalone/roles/cp/edge$ tree
.
├── cri_install
│   └── tasks
│       └── main.yml
├── edgecore
│   └── tasks
│       └── main.yml
├── edgemesh
│   └── tasks
│       └── main.yml
├── keadm_amd64
│   └── tasks
│       └── main.yml
├── keadm_arm64
│   └── tasks
│       └── main.yml
├── keadm_init
│   ├── defaults
│   │   └── main.yml
│   └── tasks
│       └── main.yml
├── keadm_join
│   ├── defaults
│   │   └── main.yml
│   └── tasks
│       └── main.yml
└── reset
    └── tasks
        └── main.yml
```

---
##### ref
1. [Kubeedge Docs](https://kubeedge.io/docs/setup/install-with-keadm)
2. 